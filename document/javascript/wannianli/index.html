<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>万年历</title>
  </head>
  <body>
    <input type="number" id="year" min="1900" max="2099" value="2021">
    <button onclick="renderCalendar()">生成</button>
    <div id="calendar"></div>

    <script>
      function renderCalendar() {
        var year = document.getElementById("year").value;
        var data = calendarData[year];

        if (!data) {
          alert("该年份暂无数据！");
          return;
        }

        var calendar = document.getElementById("calendar");
        calendar.innerHTML = "";

        for (var month in data) {
          var monthData = data[month];
          var monthTable = document.createElement("table");
          monthTable.innerHTML = "<caption>" + year + "年" + month + "月</caption><thead><tr><th>周日</th><th>周一</th><th>周二</th><th>周三</th><th>周四</th><th>周五</th><th>周六</th></tr></thead>";
          var tbody = document.createElement("tbody");
          monthTable.appendChild(tbody);
          calendar.appendChild(monthTable);

          var firstDay = new Date(monthData["1"]["solar"]).getDay(); // 该月第一天是周几
          var days = Object.keys(monthData).length; // 该月天数
          var rows = Math.ceil((firstDay + days) / 7); // 该月行数

          for (var i = 0; i < rows; i++) {
            var row = document.createElement("tr");

            for (var j = 0; j < 7; j++) {
              var day = i * 7 + j - firstDay + 1;
              var td = document.createElement("td");

              if (day >= 1 && day <= days) {
                td.innerHTML = "<span class='solar'>" + day + "</span><br><span class='lunar'>" + monthData[day]["lunar"] + "</span>";
                if (monthData[day]["festival"]) {
                  td.innerHTML += "<br><span class='festival'>" + monthData[day]["festival"] + "</span>";
                }
              }

              row.appendChild(td);
            }

            tbody.appendChild(row);
          }
        }
      }
    </script>

    <style>
      table {
        border-collapse: collapse;
        margin-bottom: 20px;
      }
      caption {
        font-weight: bold;
        font-size: 20px;
        margin-bottom: 10px;
      }
      th {
        border: 1px solid #000;
        padding: 5px;
      }
      td {
        border: 1px solid #000;
        padding: 5px;
        text-align: center;
      }
      .solar {
        font-weight: bold;
      }
      .lunar {
        color: #999;
        font-size: 12px;
      }
      .festival {
        color: red;
        font-size: 12px;
      }
    </style>
  </body>
</html>
